00421200: PUSH EBP
00421201: PUSH EDI
00421202: PUSH ESI
00421203: PUSH EBX
00421204: SUB ESP,0x2c
00421207: MOV EBX,dword ptr [ESP + 0x4c]
0042120b: MOV EAX,dword ptr [ESP + 0x44]
0042120f: MOV EDI,dword ptr [ESP + 0x40]
00421213: MOV EBP,dword ptr [ESP + 0x48]
00421217: SUB EAX,EBX
00421219: MOV dword ptr [ESP + 0x14],EAX
0042121d: JS 0x004212c0
00421223: MOVZX EAX,byte ptr [EBP]
00421227: MOV ESI,EDI
00421229: XOR EDX,EDX
0042122b: MOV byte ptr [ESP + 0x13],AL
0042122f: LEA EAX,[EBX + 0x1]
00421232: MOV dword ptr [ESP + 0x1c],EAX
00421236: JMP 0x0042124c
00421240: ADD EDX,0x1
00421243: ADD ESI,0x1
00421246: CMP EDX,dword ptr [ESP + 0x14]
0042124a: JG 0x004212c0
0042124c: MOVZX EAX,byte ptr [ESP + 0x13]
00421251: CMP byte ptr [ESI],AL
00421253: JNZ 0x00421240
00421255: XOR EAX,EAX
00421257: TEST EBX,EBX
00421259: JLE 0x0042128f
0042125b: MOV dword ptr [ESP + 0x18],ESI
0042125f: MOV dword ptr [ESP + 0x4c],EBX
00421263: MOV ESI,dword ptr [ESP + 0x1c]
00421267: JMP 0x0042127e
00421270: LEA ECX,[EDI + EAX*0x1]
00421273: MOVZX EBX,byte ptr [EBP + EAX*0x1]
00421278: CMP byte ptr [ECX + EDX*0x1],BL
0042127b: CMOVNZ EAX,ESI
0042127e: ADD EAX,0x1
00421281: CMP dword ptr [ESP + 0x4c],EAX
00421285: JG 0x00421270
00421287: MOV ESI,dword ptr [ESP + 0x18]
0042128b: MOV EBX,dword ptr [ESP + 0x4c]
0042128f: CMP EBX,EAX
00421291: JNZ 0x00421240
00421293: MOV EAX,dword ptr [ESP + 0x54]
00421297: MOV dword ptr [ESP],ESI
0042129a: MOV dword ptr [ESP + 0x8],EAX
0042129e: MOV EAX,dword ptr [ESP + 0x50]
004212a2: MOV dword ptr [ESP + 0x4],EAX
004212a6: CALL 0x004490f8
004212ab: ADD ESP,0x2c
004212ae: MOV EAX,0x1
004212b3: POP EBX
004212b4: POP ESI
004212b5: POP EDI
004212b6: POP EBP
004212b7: RET
004212c0: ADD ESP,0x2c
004212c3: XOR EAX,EAX
004212c5: POP EBX
004212c6: POP ESI
004212c7: POP EDI
004212c8: POP EBP
004212c9: RET