00420470: PUSH EDI
00420471: PUSH EBX
00420472: SUB ESP,0x134
00420478: MOV EDX,dword ptr [ESP + 0x140]
0042047f: TEST EDX,EDX
00420481: JZ 0x00420530
00420487: MOV ECX,dword ptr [ESP + 0x144]
0042048e: TEST ECX,ECX
00420490: JZ 0x00420530
00420496: LEA EDI,[ESP + 0x30]
0042049a: XOR EAX,EAX
0042049c: MOV ECX,0x40
004204a1: MOV dword ptr [ESP + 0x28],0x46444e53
004204a9: MOV dword ptr [ESP + 0x2c],0x0
004204b1: STOSD.REP ES:EDI
004204b3: LEA EAX,[ESP + 0x2c]
004204b7: LEA EDI,[ESP + 0x28]
004204bb: MOV dword ptr [ESP + 0x4],EDX
004204bf: MOV dword ptr [ESP],EAX
004204c2: CALL 0x00449080
004204c7: MOV EAX,EDI
004204c9: MOV ECX,dword ptr [EAX]
004204cb: ADD EAX,0x4
004204ce: LEA EDX,[ECX + 0xfefefeff]
004204d4: NOT ECX
004204d6: AND EDX,ECX
004204d8: AND EDX,0x80808080
004204de: JZ 0x004204c9
004204e0: MOV ECX,EDX
004204e2: SHR ECX,0x10
004204e5: TEST EDX,0x8080
004204eb: CMOVZ EDX,ECX
004204ee: LEA ECX,[EAX + 0x2]
004204f1: MOV EBX,EDX
004204f3: CMOVZ EAX,ECX
004204f6: ADD BL,DL
004204f8: MOV EDX,0xa
004204fd: SBB EAX,0x3
00420500: SUB EAX,EDI
00420502: MOV word ptr [EDI + EAX*0x1],DX
00420506: LEA EBX,[EAX + 0x1]
00420509: MOV EAX,[0x0044a6c0]
0042050e: MOV dword ptr [ESP + 0xc],0x0
00420516: MOV dword ptr [ESP + 0x4],EDI
0042051a: MOV dword ptr [ESP + 0x8],EBX
0042051e: MOV dword ptr [ESP],EAX
00420521: CALL dword ptr [0x0050f43c]
00420527: SUB ESP,0x10
0042052a: CMP EBX,EAX
0042052c: JZ 0x00420540
0042052e: NOP
00420530: XOR EAX,EAX
00420532: ADD ESP,0x134
00420538: POP EBX
00420539: POP EDI
0042053a: RET
00420540: CALL 0x00433600
00420545: TEST EAX,EAX
00420547: SETNZ AL
0042054a: MOVZX EAX,AL
0042054d: MOV dword ptr [ESP + 0x8],EAX
00420551: MOV EAX,dword ptr [ESP + 0x148]
00420558: MOV dword ptr [ESP + 0x4],EAX
0042055c: MOV EAX,dword ptr [ESP + 0x144]
00420563: MOV dword ptr [ESP],EAX
00420566: CALL 0x0041f1a0
0042056b: TEST EAX,EAX
0042056d: JZ 0x00420530
0042056f: LEA EAX,[ESP + 0x24]
00420573: CALL 0x0041e800
00420578: TEST EAX,EAX
0042057a: MOV EBX,EAX
0042057c: JZ 0x00420530
0042057e: CMP dword ptr [ESP + 0x24],0x2
00420583: JZ 0x004205a1
00420585: XOR EAX,EAX
00420587: CMP EBX,0x479578
0042058d: JZ 0x00420530
0042058f: MOV dword ptr [ESP],EBX
00420592: MOV dword ptr [ESP + 0x1c],EAX
00420596: CALL 0x00449140
0042059b: MOV EAX,dword ptr [ESP + 0x1c]
0042059f: JMP 0x00420532
004205a1: MOV dword ptr [ESP],EAX
004205a4: CALL 0x00420ab0
004205a9: CMP AX,0x4f4b
004205ad: JNZ 0x00420585
004205af: CMP EBX,0x479578
004205b5: JNZ 0x004205c1
004205b7: MOV EAX,0x1
004205bc: JMP 0x00420532
004205c1: MOV EAX,0x1
004205c6: JMP 0x0042058f