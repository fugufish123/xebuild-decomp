004100b0: PUSH EBP
004100b1: PUSH EDI
004100b2: PUSH ESI
004100b3: PUSH EBX
004100b4: SUB ESP,0x8
004100b7: MOV EDI,dword ptr [ESP + 0x24]
004100bb: MOV ECX,dword ptr [ESP + 0x1c]
004100bf: MOV EBX,dword ptr [ESP + 0x20]
004100c3: CMP EDI,0x1
004100c6: LEA ESI,[ECX + 0x200]
004100cc: SBB EAX,EAX
004100ce: MOV EDX,EBX
004100d0: MOV byte ptr [ESP + 0x6],BL
004100d4: AND AL,0x20
004100d6: SHR EDX,0x8
004100d9: ADD EAX,0x100
004100de: IMUL EAX,EAX,0x210
004100e4: LEA EAX,[ECX + EAX*0x1 + 0x200]
004100eb: MOV dword ptr [ESP],EAX
004100ee: MOV EAX,EDX
004100f0: AND EAX,0xf
004100f3: MOV byte ptr [ESP + 0x7],AL
004100f7: MOV ESI,ESI
004100f9: LEA EDI,[EDI]
00410100: TEST EDI,EDI
00410102: MOV dword ptr [ESI],0x0
00410108: MOV dword ptr [ESI + 0x4],0x0
0041010f: MOV dword ptr [ESI + 0x8],0x0
00410116: MOV dword ptr [ESI + 0xc],0x0
0041011d: JZ 0x004101d8
00410123: MOVZX EAX,byte ptr [ESI + 0x2]
00410127: MOV byte ptr [ESI],0xff
0041012a: AND EAX,0xfffffff0
0041012d: OR AL,byte ptr [ESP + 0x7]
00410131: MOV byte ptr [ESI + 0x2],AL
00410134: MOVZX EAX,byte ptr [ESP + 0x6]
00410139: MOV byte ptr [ESI + 0x1],AL
0041013c: XOR EAX,EAX
0041013e: LEA EBX,[ESI + 0xfffffe00]
00410144: XOR ECX,ECX
00410146: XOR EDX,EDX
00410148: MOV EBP,EAX
0041014a: LEA ESI,[ESI]
00410150: TEST DL,0x1f
00410153: JNZ 0x00410167
00410155: MOV EAX,EBX
00410157: CMP EDX,0x1000
0041015d: CMOVZ EAX,ESI
00410160: MOV ECX,dword ptr [EAX]
00410162: LEA EBX,[EAX + 0x4]
00410165: NOT ECX
00410167: MOV EAX,ECX
00410169: SHR ECX,0x1
0041016b: AND EAX,0x1
0041016e: XOR EAX,EBP
00410170: MOV EBP,EAX
00410172: XOR EBP,0x6954559
00410178: TEST AL,0x1
0041017a: CMOVNZ EAX,EBP
0041017d: ADD EDX,0x1
00410180: SHR EAX,0x1
00410182: CMP EDX,0x1066
00410188: MOV EBP,EAX
0041018a: JNZ 0x00410150
0041018c: MOVZX EDX,byte ptr [ESI + 0xc]
00410190: NOT EAX
00410192: ADD ESI,0x210
00410198: MOV ECX,EAX
0041019a: SHL ECX,0x6
0041019d: AND EDX,0x3f
004101a0: ADD EDX,ECX
004101a2: MOV byte ptr [ESI + 0xfffffdfc],DL
004101a8: MOV EDX,EAX
004101aa: SHR EDX,0x2
004101ad: MOV byte ptr [ESI + 0xfffffdfd],DL
004101b3: MOV EDX,EAX
004101b5: SHR EAX,0x12
004101b8: SHR EDX,0xa
004101bb: MOV byte ptr [ESI + 0xfffffdff],AL
004101c1: MOV byte ptr [ESI + 0xfffffdfe],DL
004101c7: CMP dword ptr [ESP],ESI
004101ca: JNZ 0x00410100
004101d0: ADD ESP,0x8
004101d3: POP EBX
004101d4: POP ESI
004101d5: POP EDI
004101d6: POP EBP
004101d7: RET
004101d8: MOV EAX,[0x00479ef4]
004101dd: TEST EAX,EAX
004101df: JZ 0x00410200
004101e1: MOVZX EAX,byte ptr [ESI + 0x2]
004101e5: MOV byte ptr [ESI + 0x5],0xff
004101e9: AND EAX,0xfffffff0
004101ec: OR AL,byte ptr [ESP + 0x7]
004101f0: MOV byte ptr [ESI + 0x2],AL
004101f3: MOVZX EAX,byte ptr [ESP + 0x6]
004101f8: MOV byte ptr [ESI + 0x1],AL
004101fb: JMP 0x0041013c
00410200: MOVZX EAX,byte ptr [ESI + 0x1]
00410204: MOV byte ptr [ESI + 0x5],0xff
00410208: AND EAX,0xfffffff0
0041020b: OR AL,byte ptr [ESP + 0x7]
0041020f: MOV byte ptr [ESI + 0x1],AL
00410212: MOVZX EAX,byte ptr [ESP + 0x6]
00410217: MOV byte ptr [ESI],AL
00410219: JMP 0x0041013c