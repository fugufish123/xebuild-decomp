004389b0: PUSH EBP
004389b1: PUSH EDI
004389b2: PUSH ESI
004389b3: PUSH EBX
004389b4: SUB ESP,0x2c
004389b7: MOV ESI,dword ptr [ESP + 0x4c]
004389bb: LEA EDI,[ESI*0x4 + 0x0]
004389c2: MOV dword ptr [ESP],EDI
004389c5: CALL 0x004421a0
004389ca: TEST EAX,EAX
004389cc: MOV EBX,EAX
004389ce: JZ 0x004389e2
004389d0: MOV dword ptr [ESP + 0x4],EDI
004389d4: MOV dword ptr [ESP],EAX
004389d7: CALL 0x004410e0
004389dc: MOV dword ptr [EBX],0x0
004389e2: MOV EAX,dword ptr [ESP + 0x44]
004389e6: MOV dword ptr [EBX + ESI*0x8],0xf1f1f1f1
004389ed: MOV dword ptr [ESP],ESI
004389f0: MOV dword ptr [ESP + 0x4],EAX
004389f4: CALL 0x00436fe0
004389f9: MOV EDI,EAX
004389fb: MOV EAX,dword ptr [ESP + 0x48]
004389ff: MOV dword ptr [ESP],ESI
00438a02: MOV dword ptr [ESP + 0x4],EAX
00438a06: CALL 0x00436fe0
00438a0b: TEST EDI,EDI
00438a0d: MOV EBP,EAX
00438a0f: JZ 0x00438a15
00438a11: TEST EAX,EAX
00438a13: JNZ 0x00438a50
00438a15: MOV dword ptr [ESP + 0x18],0x0
00438a1d: TEST EBX,EBX
00438a1f: JZ 0x00438a29
00438a21: MOV dword ptr [ESP],EBX
00438a24: CALL 0x004421f0
00438a29: TEST EDI,EDI
00438a2b: JZ 0x00438a35
00438a2d: MOV dword ptr [ESP],EDI
00438a30: CALL 0x004421f0
00438a35: TEST EBP,EBP
00438a37: JZ 0x00438a41
00438a39: MOV dword ptr [ESP],EBP
00438a3c: CALL 0x004421f0
00438a41: MOV EAX,dword ptr [ESP + 0x18]
00438a45: ADD ESP,0x2c
00438a48: POP EBX
00438a49: POP ESI
00438a4a: POP EDI
00438a4b: POP EBP
00438a4c: RET
00438a50: LEA ECX,[ESI + ESI*0x1]
00438a53: MOV dword ptr [ESP + 0x8],EAX
00438a57: MOV dword ptr [ESP + 0x4],EDI
00438a5b: MOV dword ptr [ESP],EBX
00438a5e: MOV dword ptr [ESP + 0xc],ECX
00438a62: MOV dword ptr [ESP + 0x1c],ECX
00438a66: CALL 0x004420b0
00438a6b: TEST EAX,EAX
00438a6d: SETNZ AL
00438a70: MOVZX EAX,AL
00438a73: MOV dword ptr [ESP + 0x18],EAX
00438a77: MOV EAX,dword ptr [ESP + 0x40]
00438a7b: TEST EAX,EAX
00438a7d: JZ 0x00438a1d
00438a7f: TEST EBX,EBX
00438a81: JZ 0x00438a1d
00438a83: TEST ESI,ESI
00438a85: MOV ECX,dword ptr [ESP + 0x1c]
00438a89: JZ 0x00438a21
00438a8b: TEST ECX,ECX
00438a8d: JLE 0x00438a21
00438a8f: MOV EAX,dword ptr [ESP + 0x40]
00438a93: MOV dword ptr [ESP + 0x1c],EDI
00438a97: MOV EDX,EBX
00438a99: MOV EDI,EBX
00438a9b: LEA ECX,[EAX + ECX*0x4]
00438a9e: MOV ESI,ECX
00438aa0: MOV ECX,dword ptr [EDX + 0x4]
00438aa3: ADD EAX,0x8
00438aa6: ADD EDX,0x8
00438aa9: MOV EBX,ECX
00438aab: MOV byte ptr [EAX + -0x5],CL
00438aae: SHR EBX,0x18
00438ab1: MOV byte ptr [EAX + -0x8],BL
00438ab4: MOV EBX,ECX
00438ab6: SHR EBX,0x10
00438ab9: MOV byte ptr [EAX + -0x7],BL
00438abc: MOV EBX,ECX
00438abe: SHR EBX,0x8
00438ac1: MOV byte ptr [EAX + -0x6],BL
00438ac4: MOV ECX,dword ptr [EDX + -0x8]
00438ac7: MOV EBX,ECX
00438ac9: MOV byte ptr [EAX + -0x1],CL
00438acc: SHR EBX,0x18
00438acf: MOV byte ptr [EAX + -0x4],BL
00438ad2: MOV EBX,ECX
00438ad4: SHR EBX,0x10
00438ad7: MOV byte ptr [EAX + -0x3],BL
00438ada: MOV EBX,ECX
00438adc: SHR EBX,0x8
00438adf: MOV byte ptr [EAX + -0x2],BL
00438ae2: CMP ESI,EAX
00438ae4: JNZ 0x00438aa0
00438ae6: MOV EBX,EDI
00438ae8: MOV EDI,dword ptr [ESP + 0x1c]
00438aec: JMP 0x00438a21