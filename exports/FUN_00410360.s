00410360: PUSH EDI
00410361: PUSH ESI
00410362: PUSH EBX
00410363: SUB ESP,0x10
00410366: MOV EDX,dword ptr [0x00479ef0]
0041036c: MOV EAX,[0x00479ed8]
00410371: MOV EBX,dword ptr [ESP + 0x20]
00410375: TEST EBX,EBX
00410377: CMOVZ EBX,dword ptr [0x004cd840]
0041037e: TEST EDX,EDX
00410380: JZ 0x00410400
00410382: ADD EBX,0x1ffff
00410388: AND EBX,0xfffe0000
0041038e: CMP dword ptr [0x00479ea8],0x1
00410395: JZ 0x00410410
00410397: MOV EDX,EBX
00410399: MOV ECX,EBX
0041039b: SHL EDX,0x8
0041039e: SHR ECX,0x8
004103a1: AND ECX,0xff00
004103a7: AND EDX,0xff0000
004103ad: OR EDX,ECX
004103af: MOV ECX,EBX
004103b1: SHR ECX,0x18
004103b4: ADD EDX,ECX
004103b6: MOV dword ptr [EAX + 0x64],EDX
004103b9: MOV dword ptr [EAX + 0xc],EDX
004103bc: MOV ECX,EDX
004103be: MOV EAX,EDX
004103c0: SHL ECX,0x8
004103c3: SHL EDX,0x18
004103c6: SHR EAX,0x8
004103c9: AND ECX,0xff0000
004103cf: MOV dword ptr [ESP + 0x4],0x45187c
004103d7: AND EAX,0xff00
004103dc: MOV dword ptr [ESP],0x1
004103e3: OR ECX,EAX
004103e5: ADD EDX,ECX
004103e7: MOV dword ptr [ESP + 0x8],EDX
004103eb: CALL 0x00433690
004103f0: ADD ESP,0x10
004103f3: MOV EAX,EBX
004103f5: POP EBX
004103f6: POP ESI
004103f7: POP EDI
004103f8: RET
00410400: ADD EBX,0x3fff
00410406: AND EBX,0xffffc000
0041040c: JMP 0x00410397
00410410: MOV EDI,dword ptr [EAX + 0x70]
00410413: MOV ECX,EDI
00410415: MOV ESI,EDI
00410417: MOV EDX,EDI
00410419: SHL ECX,0x18
0041041c: SHR ESI,0x18
0041041f: SHL EDX,0x8
00410422: AND EDX,0xff0000
00410428: ADD ESI,ECX
0041042a: SHR EDI,0x8
0041042d: LEA ECX,[ESI + EDX*0x1]
00410430: AND EDI,0xff00
00410436: LEA EDX,[ECX + EDI*0x1]
00410439: LEA ECX,[EDX + EDX*0x1]
0041043c: TEST EDX,EDX
0041043e: MOV EDX,0x20000
00410443: CMOVNZ EDX,ECX
00410446: ADD EDX,EBX
00410448: SHR EDX,0x11
0041044b: MOV byte ptr [0x00479ece],DL
00410451: JMP 0x00410397