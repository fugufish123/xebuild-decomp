0040abf0: PUSH EBP
0040abf1: PUSH EDI
0040abf2: PUSH ESI
0040abf3: PUSH EBX
0040abf4: SUB ESP,0x3c
0040abf7: MOV EBX,dword ptr [0x004c97ac]
0040abfd: MOV EDI,dword ptr [ESP + 0x50]
0040ac01: TEST EBX,EBX
0040ac03: JZ 0x0040ace0
0040ac09: MOV EAX,[0x004c93a4]
0040ac0e: MOV dword ptr [ESP],EDI
0040ac11: MOV ESI,EAX
0040ac13: MOV dword ptr [ESP + 0x18],EAX
0040ac17: CALL 0x00449078
0040ac1c: SUB EBX,EAX
0040ac1e: TEST EBX,EBX
0040ac20: MOV dword ptr [ESP + 0x24],EBX
0040ac24: JLE 0x0040ace0
0040ac2a: MOVSX ECX,byte ptr [EDI]
0040ac2d: ADD ESI,EAX
0040ac2f: MOV dword ptr [ESP + 0x1c],ESI
0040ac33: XOR ESI,ESI
0040ac35: MOV dword ptr [ESP + 0x20],ECX
0040ac39: LEA ECX,[EAX + 0x1]
0040ac3c: MOV dword ptr [ESP + 0x2c],ECX
0040ac40: JMP 0x0040ac54
0040ac42: ADD ESI,0x1
0040ac45: ADD dword ptr [ESP + 0x1c],0x1
0040ac4a: CMP ESI,dword ptr [ESP + 0x24]
0040ac4e: JZ 0x0040ace0
0040ac54: MOV EBX,dword ptr [ESP + 0x18]
0040ac58: MOVZX EDX,byte ptr [EBX + ESI*0x1]
0040ac5c: CMP EDX,dword ptr [ESP + 0x20]
0040ac60: JNZ 0x0040ac42
0040ac62: XOR EDX,EDX
0040ac64: TEST EAX,EAX
0040ac66: JLE 0x0040ac8e
0040ac68: LEA EBP,[EBX + ESI*0x1]
0040ac6b: MOV dword ptr [ESP + 0x28],ESI
0040ac6f: MOV ESI,dword ptr [ESP + 0x2c]
0040ac73: JMP 0x0040ac83
0040ac75: MOVZX EBX,byte ptr [EBP + EDX*0x1]
0040ac7a: MOVSX ECX,byte ptr [EDI + EDX*0x1]
0040ac7e: CMP EBX,ECX
0040ac80: CMOVNZ EDX,ESI
0040ac83: ADD EDX,0x1
0040ac86: CMP EAX,EDX
0040ac88: JG 0x0040ac75
0040ac8a: MOV ESI,dword ptr [ESP + 0x28]
0040ac8e: CMP EAX,EDX
0040ac90: JNZ 0x0040ac42
0040ac92: MOV EBX,dword ptr [ESP + 0x1c]
0040ac96: LEA EDX,[EAX + ESI*0x1]
0040ac99: CMP byte ptr [EBX],0x0
0040ac9c: JZ 0x0040ac42
0040ac9e: CMP EDX,-0x1
0040aca1: JZ 0x0040ace0
0040aca3: MOV dword ptr [ESP + 0x8],0x4
0040acab: MOV dword ptr [ESP + 0x4],0x450258
0040acb3: MOV dword ptr [ESP],EBX
0040acb6: CALL 0x004491d0
0040acbb: TEST EAX,EAX
0040acbd: JZ 0x0040ace0
0040acbf: MOV dword ptr [ESP + 0x8],0x5
0040acc7: MOV dword ptr [ESP + 0x4],0x45025d
0040accf: MOV dword ptr [ESP],EBX
0040acd2: CALL 0x004491d0
0040acd7: MOV EDX,EAX
0040acd9: MOV EAX,EBX
0040acdb: TEST EDX,EDX
0040acdd: JNZ 0x0040ace2
0040acdf: NOP
0040ace0: XOR EAX,EAX
0040ace2: ADD ESP,0x3c
0040ace5: POP EBX
0040ace6: POP ESI
0040ace7: POP EDI
0040ace8: POP EBP
0040ace9: RET