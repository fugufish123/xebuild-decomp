00420710: PUSH EDI
00420711: PUSH EBX
00420712: XOR EAX,EAX
00420714: SUB ESP,0x134
0042071a: MOV EDX,dword ptr [ESP + 0x140]
00420721: TEST EDX,EDX
00420723: JZ 0x004207c1
00420729: LEA EDI,[ESP + 0x30]
0042072d: MOV ECX,0x40
00420732: MOV dword ptr [ESP + 0x28],0x52444b4d
0042073a: MOV dword ptr [ESP + 0x2c],0x0
00420742: STOSD.REP ES:EDI
00420744: LEA EAX,[ESP + 0x2c]
00420748: LEA EDI,[ESP + 0x28]
0042074c: MOV dword ptr [ESP + 0x4],EDX
00420750: MOV dword ptr [ESP],EAX
00420753: CALL 0x00449080
00420758: MOV EAX,EDI
0042075a: MOV ECX,dword ptr [EAX]
0042075c: ADD EAX,0x4
0042075f: LEA EDX,[ECX + 0xfefefeff]
00420765: NOT ECX
00420767: AND EDX,ECX
00420769: AND EDX,0x80808080
0042076f: JZ 0x0042075a
00420771: MOV ECX,EDX
00420773: SHR ECX,0x10
00420776: TEST EDX,0x8080
0042077c: CMOVZ EDX,ECX
0042077f: LEA ECX,[EAX + 0x2]
00420782: MOV EBX,EDX
00420784: CMOVZ EAX,ECX
00420787: ADD BL,DL
00420789: MOV EDX,0xa
0042078e: SBB EAX,0x3
00420791: SUB EAX,EDI
00420793: MOV word ptr [EDI + EAX*0x1],DX
00420797: LEA EBX,[EAX + 0x1]
0042079a: MOV EAX,[0x0044a6c0]
0042079f: MOV dword ptr [ESP + 0xc],0x0
004207a7: MOV dword ptr [ESP + 0x4],EDI
004207ab: MOV dword ptr [ESP + 0x8],EBX
004207af: MOV dword ptr [ESP],EAX
004207b2: CALL dword ptr [0x0050f43c]
004207b8: SUB ESP,0x10
004207bb: CMP EBX,EAX
004207bd: JZ 0x004207d0
004207bf: XOR EAX,EAX
004207c1: ADD ESP,0x134
004207c7: POP EBX
004207c8: POP EDI
004207c9: RET
004207d0: LEA EAX,[ESP + 0x24]
004207d4: CALL 0x0041e800
004207d9: TEST EAX,EAX
004207db: MOV EBX,EAX
004207dd: JZ 0x004207bf
004207df: CMP dword ptr [ESP + 0x24],0x2
004207e4: JZ 0x00420810
004207e6: XOR EAX,EAX
004207e8: CMP EBX,0x479578
004207ee: JZ 0x004207bf
004207f0: MOV dword ptr [ESP],EBX
004207f3: MOV dword ptr [ESP + 0x1c],EAX
004207f7: CALL 0x00449140
004207fc: MOV EAX,dword ptr [ESP + 0x1c]
00420800: ADD ESP,0x134
00420806: POP EBX
00420807: POP EDI
00420808: RET
00420810: MOV dword ptr [ESP],EBX
00420813: CALL 0x00420ab0
00420818: CMP AX,0x4f4b
0042081c: JNZ 0x004207e6
0042081e: CMP EBX,0x479578
00420824: JNZ 0x0042082d
00420826: MOV EAX,0x1
0042082b: JMP 0x004207c1
0042082d: MOV EAX,0x1
00420832: JMP 0x004207f0