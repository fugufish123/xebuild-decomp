00421170: PUSH EBP
00421171: PUSH EDI
00421172: PUSH ESI
00421173: PUSH EBX
00421174: SUB ESP,0x8
00421177: MOV ESI,dword ptr [ESP + 0x28]
0042117b: MOV EAX,dword ptr [ESP + 0x20]
0042117f: MOV EBX,dword ptr [ESP + 0x1c]
00421183: MOV EDI,dword ptr [ESP + 0x24]
00421187: SUB EAX,ESI
00421189: MOV dword ptr [ESP + 0x4],EAX
0042118d: JS 0x004211f0
0042118f: MOVZX EAX,byte ptr [EDI]
00421192: XOR EDX,EDX
00421194: LEA EBP,[ESI + 0x1]
00421197: MOV byte ptr [ESP + 0x3],AL
0042119b: JMP 0x004211a9
004211a0: ADD EDX,0x1
004211a3: CMP EDX,dword ptr [ESP + 0x4]
004211a7: JG 0x004211f0
004211a9: MOVZX EAX,byte ptr [ESP + 0x3]
004211ae: CMP byte ptr [EBX + EDX*0x1],AL
004211b1: JNZ 0x004211a0
004211b3: XOR EAX,EAX
004211b5: TEST ESI,ESI
004211b7: JLE 0x004211db
004211b9: MOV dword ptr [ESP + 0x1c],EBX
004211bd: JMP 0x004211d0
004211c0: MOV ECX,dword ptr [ESP + 0x1c]
004211c4: MOVZX EBX,byte ptr [EDI + EAX*0x1]
004211c8: ADD ECX,EAX
004211ca: CMP byte ptr [ECX + EDX*0x1],BL
004211cd: CMOVNZ EAX,EBP
004211d0: ADD EAX,0x1
004211d3: CMP ESI,EAX
004211d5: JG 0x004211c0
004211d7: MOV EBX,dword ptr [ESP + 0x1c]
004211db: CMP ESI,EAX
004211dd: JNZ 0x004211a0
004211df: ADD ESP,0x8
004211e2: MOV EAX,0x1
004211e7: POP EBX
004211e8: POP ESI
004211e9: POP EDI
004211ea: POP EBP
004211eb: RET
004211f0: ADD ESP,0x8
004211f3: XOR EAX,EAX
004211f5: POP EBX
004211f6: POP ESI
004211f7: POP EDI
004211f8: POP EBP
004211f9: RET