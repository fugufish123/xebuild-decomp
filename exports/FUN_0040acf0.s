0040acf0: PUSH EBP
0040acf1: PUSH EDI
0040acf2: PUSH ESI
0040acf3: PUSH EBX
0040acf4: SUB ESP,0x3c
0040acf7: MOV EBX,dword ptr [0x004c97ac]
0040acfd: MOV EAX,dword ptr [ESP + 0x54]
0040ad01: MOV EDI,dword ptr [ESP + 0x50]
0040ad05: TEST EBX,EBX
0040ad07: MOV dword ptr [ESP + 0x2c],EAX
0040ad0b: JNZ 0x0040ad20
0040ad0d: MOV EAX,dword ptr [ESP + 0x2c]
0040ad11: ADD ESP,0x3c
0040ad14: POP EBX
0040ad15: POP ESI
0040ad16: POP EDI
0040ad17: POP EBP
0040ad18: RET
0040ad20: MOV EAX,[0x004c93a4]
0040ad25: MOV dword ptr [ESP],EDI
0040ad28: MOV ESI,EAX
0040ad2a: MOV dword ptr [ESP + 0x14],EAX
0040ad2e: CALL 0x00449078
0040ad33: SUB EBX,EAX
0040ad35: TEST EBX,EBX
0040ad37: MOV dword ptr [ESP + 0x20],EBX
0040ad3b: JLE 0x0040ad0d
0040ad3d: MOVSX ECX,byte ptr [EDI]
0040ad40: ADD ESI,EAX
0040ad42: MOV dword ptr [ESP + 0x18],ESI
0040ad46: XOR ESI,ESI
0040ad48: MOV dword ptr [ESP + 0x1c],ECX
0040ad4c: LEA ECX,[EAX + 0x1]
0040ad4f: MOV dword ptr [ESP + 0x28],ECX
0040ad53: JMP 0x0040ad63
0040ad55: ADD ESI,0x1
0040ad58: ADD dword ptr [ESP + 0x18],0x1
0040ad5d: CMP ESI,dword ptr [ESP + 0x20]
0040ad61: JZ 0x0040ad0d
0040ad63: MOV EBX,dword ptr [ESP + 0x14]
0040ad67: MOVZX EDX,byte ptr [EBX + ESI*0x1]
0040ad6b: CMP EDX,dword ptr [ESP + 0x1c]
0040ad6f: JNZ 0x0040ad55
0040ad71: XOR EDX,EDX
0040ad73: TEST EAX,EAX
0040ad75: JLE 0x0040ad9d
0040ad77: LEA EBP,[EBX + ESI*0x1]
0040ad7a: MOV dword ptr [ESP + 0x24],ESI
0040ad7e: MOV ESI,dword ptr [ESP + 0x28]
0040ad82: JMP 0x0040ad92
0040ad84: MOVZX EBX,byte ptr [EBP + EDX*0x1]
0040ad89: MOVSX ECX,byte ptr [EDI + EDX*0x1]
0040ad8d: CMP EBX,ECX
0040ad8f: CMOVNZ EDX,ESI
0040ad92: ADD EDX,0x1
0040ad95: CMP EAX,EDX
0040ad97: JG 0x0040ad84
0040ad99: MOV ESI,dword ptr [ESP + 0x24]
0040ad9d: CMP EAX,EDX
0040ad9f: JNZ 0x0040ad55
0040ada1: MOV EBX,dword ptr [ESP + 0x18]
0040ada5: LEA EDX,[EAX + ESI*0x1]
0040ada8: CMP byte ptr [EBX],0x0
0040adab: JZ 0x0040ad55
0040adad: CMP EDX,-0x1
0040adb0: JZ 0x0040ad0d
0040adb6: MOV EAX,dword ptr [ESP + 0x2c]
0040adba: MOV dword ptr [ESP + 0x54],EAX
0040adbe: MOV EAX,dword ptr [ESP + 0x18]
0040adc2: MOV dword ptr [ESP + 0x50],EAX
0040adc6: ADD ESP,0x3c
0040adc9: POP EBX
0040adca: POP ESI
0040adcb: POP EDI
0040adcc: POP EBP
0040adcd: JMP 0x00421860