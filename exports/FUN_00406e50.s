00406e50: PUSH EBP
00406e51: PUSH EDI
00406e52: PUSH ESI
00406e53: PUSH EBX
00406e54: SUB ESP,0x3c
00406e57: CMP dword ptr [ESP + 0x58],0x1
00406e5c: MOV EBX,dword ptr [ESP + 0x54]
00406e60: MOV dword ptr [ESP + 0x2c],0xffffffff
00406e68: JBE 0x00407034
00406e6e: LEA ESI,[ESP + 0x2c]
00406e72: MOV dword ptr [ESP + 0x4],0x44eee4
00406e7a: MOV dword ptr [ESP],0x0
00406e81: CALL 0x00433690
00406e86: MOV dword ptr [ESP + 0xc],0x4
00406e8e: MOV dword ptr [ESP + 0x8],ESI
00406e92: MOV EAX,dword ptr [EBX]
00406e94: MOV dword ptr [ESP + 0x4],EAX
00406e98: MOV EAX,dword ptr [ESP + 0x50]
00406e9c: MOV dword ptr [ESP],EAX
00406e9f: CALL 0x004210b0
00406ea4: CMP EAX,0x3
00406ea7: JZ 0x00406ed0
00406ea9: MOV dword ptr [ESP + 0x4],0x44ef10
00406eb1: MOV dword ptr [ESP],0x0
00406eb8: CALL 0x00433690
00406ebd: XOR EAX,EAX
00406ebf: ADD ESP,0x3c
00406ec2: POP EBX
00406ec3: POP ESI
00406ec4: POP EDI
00406ec5: POP EBP
00406ec6: RET
00406ed0: MOV dword ptr [ESP + 0xc],0x4
00406ed8: MOV dword ptr [ESP + 0x8],ESI
00406edc: MOV EAX,dword ptr [EBX]
00406ede: MOV dword ptr [ESP + 0x4],EAX
00406ee2: MOV EAX,dword ptr [ESP + 0x50]
00406ee6: MOV dword ptr [ESP],EAX
00406ee9: CALL 0x00421000
00406eee: TEST EAX,EAX
00406ef0: JZ 0x00406ebd
00406ef2: MOV EDX,dword ptr [ESP + 0x50]
00406ef6: SUB EDX,EAX
00406ef8: ADD EDX,dword ptr [EBX]
00406efa: ADD EAX,0x4
00406efd: MOV dword ptr [ESP + 0xc],0x4
00406f05: MOV dword ptr [ESP + 0x8],ESI
00406f09: MOV dword ptr [ESP],EAX
00406f0c: MOV dword ptr [ESP + 0x4],EDX
00406f10: CALL 0x00421000
00406f15: TEST EAX,EAX
00406f17: MOV dword ptr [ESP + 0x14],EAX
00406f1b: JZ 0x00406ebd
00406f1d: MOV EDX,dword ptr [ESP + 0x50]
00406f21: LEA ESI,[EAX + 0x4]
00406f24: SUB EDX,ESI
00406f26: ADD EDX,dword ptr [EBX]
00406f28: CMP dword ptr [ESP + 0x58],0x2
00406f2d: JZ 0x004070f1
00406f33: TEST EDX,EDX
00406f35: MOV dword ptr [ESP + 0x10],0x0
00406f3d: JZ 0x00407150
00406f43: MOV EAX,dword ptr [ESP + 0x10]
00406f47: MOV ECX,dword ptr [ESP + 0x50]
00406f4b: MOV EDI,dword ptr [ESP + 0x50]
00406f4f: ADD ECX,EAX
00406f51: LEA EDI,[EDI + EAX*0x1 + 0x4]
00406f55: MOV EAX,dword ptr [ESP + 0x14]
00406f59: MOV dword ptr [ESP + 0x18],ECX
00406f5d: CMP ESI,EDI
00406f5f: SETNC CL
00406f62: LEA EDI,[EAX + 0x8]
00406f65: CMP dword ptr [ESP + 0x18],EDI
00406f69: MOV EBP,ECX
00406f6b: SETNC CL
00406f6e: MOV EDI,ECX
00406f70: OR EDI,EBP
00406f72: CMP EDX,0x9
00406f75: SETA CL
00406f78: MOV EBP,ECX
00406f7a: MOV ECX,EDI
00406f7c: MOV EAX,EBP
00406f7e: TEST CL,AL
00406f80: JZ 0x00407120
00406f86: MOV ECX,dword ptr [ESP + 0x18]
00406f8a: OR ESI,ECX
00406f8c: AND ESI,0x3
00406f8f: JNZ 0x00407120
00406f95: TEST EDX,EDX
00406f97: MOV ESI,0x1
00406f9c: MOV EAX,dword ptr [ESP + 0x14]
00406fa0: CMOVNZ ESI,EDX
00406fa3: MOV dword ptr [ESP + 0x18],EDX
00406fa7: XOR EDI,EDI
00406fa9: LEA EBP,[ESI + -0x4]
00406fac: MOV dword ptr [ESP + 0x1c],ESI
00406fb0: SHR EBP,0x2
00406fb3: ADD EBP,0x1
00406fb6: LEA ESI,[EBP*0x4 + 0x0]
00406fbd: MOV EDX,dword ptr [EAX + EDI*0x4 + 0x4]
00406fc1: MOV dword ptr [ECX + EDI*0x4],EDX
00406fc4: ADD EDI,0x1
00406fc7: CMP EBP,EDI
00406fc9: JA 0x00406fbd
00406fcb: CMP dword ptr [ESP + 0x1c],ESI
00406fcf: MOV EDX,dword ptr [ESP + 0x18]
00406fd3: MOV dword ptr [ESP + 0x14],EAX
00406fd7: MOV dword ptr [ESP + 0x18],ECX
00406fdb: JZ 0x00407019
00406fdd: MOV EDI,ECX
00406fdf: MOV ECX,EAX
00406fe1: MOVZX EAX,byte ptr [EAX + ESI*0x1 + 0x4]
00406fe6: MOV byte ptr [EDI + ESI*0x1],AL
00406fe9: LEA EDI,[ESI + 0x1]
00406fec: CMP EDX,EDI
00406fee: JBE 0x00407019
00406ff0: MOVZX EBP,byte ptr [ECX + ESI*0x1 + 0x5]
00406ff5: ADD EDI,dword ptr [ESP + 0x50]
00406ff9: ADD ESI,0x2
00406ffc: MOV ECX,dword ptr [ESP + 0x10]
00407000: CMP EDX,ESI
00407002: MOV EAX,EBP
00407004: MOV byte ptr [EDI + ECX*0x1],AL
00407007: JBE 0x00407019
00407009: MOV EAX,dword ptr [ESP + 0x14]
0040700d: MOV EDI,dword ptr [ESP + 0x18]
00407011: MOVZX EAX,byte ptr [EAX + ESI*0x1 + 0x4]
00407016: MOV byte ptr [EDI + ESI*0x1],AL
00407019: MOV EAX,dword ptr [ESP + 0x10]
0040701d: TEST EAX,EAX
0040701f: JNZ 0x004070a0
00407021: ADD EDX,dword ptr [ESP + 0x10]
00407025: MOV EAX,0x1
0040702a: MOV dword ptr [EBX],EDX
0040702c: ADD ESP,0x3c
0040702f: POP EBX
00407030: POP ESI
00407031: POP EDI
00407032: POP EBP
00407033: RET
00407034: LEA EAX,[ESP + 0x2c]
00407038: MOV dword ptr [ESP + 0xc],0x4
00407040: MOV dword ptr [ESP + 0x8],EAX
00407044: MOV EAX,dword ptr [EBX]
00407046: MOV dword ptr [ESP + 0x4],EAX
0040704a: MOV EAX,dword ptr [ESP + 0x50]
0040704e: MOV dword ptr [ESP],EAX
00407051: CALL 0x004210b0
00407056: MOV dword ptr [ESP + 0x4],0x44ef50
0040705e: MOV EBX,EAX
00407060: MOV dword ptr [ESP],0x0
00407067: CALL 0x00433690
0040706c: CMP EBX,0x4
0040706f: MOV EAX,0x1
00407074: JZ 0x00406ebf
0040707a: MOV dword ptr [ESP + 0x8],EBX
0040707e: MOV dword ptr [ESP + 0x4],0x44ef7c
00407086: MOV dword ptr [ESP],0x0
0040708d: CALL 0x00433690
00407092: ADD ESP,0x3c
00407095: XOR EAX,EAX
00407097: POP EBX
00407098: POP ESI
00407099: POP EDI
0040709a: POP EBP
0040709b: RET
004070a0: CMP EAX,0x4
004070a3: JC 0x00407103
004070a5: MOV EAX,dword ptr [ESP + 0x50]
004070a9: MOV dword ptr [EAX],0xffffffff
004070af: MOV ECX,dword ptr [ESP + 0x50]
004070b3: MOV EDI,dword ptr [ESP + 0x10]
004070b7: MOV dword ptr [ECX + EDI*0x1 + -0x4],0xffffffff
004070bf: MOV EAX,dword ptr [ESP + 0x50]
004070c3: LEA ECX,[EAX + 0x4]
004070c6: AND ECX,0xfffffffc
004070c9: SUB EAX,ECX
004070cb: ADD EAX,EDI
004070cd: AND EAX,0xfffffffc
004070d0: CMP EAX,0x4
004070d3: JC 0x00407021
004070d9: AND EAX,0xfffffffc
004070dc: XOR ESI,ESI
004070de: MOV dword ptr [ECX + ESI*0x1],0xffffffff
004070e5: ADD ESI,0x4
004070e8: CMP ESI,EAX
004070ea: JC 0x004070de
004070ec: JMP 0x00407021
004070f1: TEST EDX,EDX
004070f3: MOV dword ptr [ESP + 0x10],0x10
004070fb: JNZ 0x00406f43
00407101: JMP 0x004070a5
00407103: TEST EAX,EAX
00407105: JZ 0x00407021
0040710b: MOV EAX,dword ptr [ESP + 0x50]
0040710f: MOV byte ptr [EAX],0xff
00407112: JMP 0x00407021
00407120: MOV EAX,dword ptr [ESP + 0x14]
00407124: MOV ECX,dword ptr [ESP + 0x18]
00407128: XOR ESI,ESI
0040712a: MOV EDI,EBX
0040712c: LEA ESI,[ESI]
00407130: MOVZX EBX,byte ptr [EAX + ESI*0x1 + 0x4]
00407135: MOV byte ptr [ECX + ESI*0x1],BL
00407138: ADD ESI,0x1
0040713b: CMP EDX,ESI
0040713d: JA 0x00407130
0040713f: MOV EBX,EDI
00407141: JMP 0x00407019
00407150: MOV dword ptr [ESP + 0x10],EDX
00407154: JMP 0x00407021