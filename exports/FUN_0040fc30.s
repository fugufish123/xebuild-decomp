0040fc30: PUSH EDI
0040fc31: PUSH ESI
0040fc32: XOR ECX,ECX
0040fc34: PUSH EBX
0040fc35: MOV ESI,dword ptr [ESP + 0x14]
0040fc39: XOR EAX,EAX
0040fc3b: MOV EBX,dword ptr [ESP + 0x10]
0040fc3f: XOR EDX,EDX
0040fc41: TEST DL,0x1f
0040fc44: JNZ 0x0040fc56
0040fc46: CMP EDX,0x1000
0040fc4c: CMOVZ EBX,ESI
0040fc4f: MOV ECX,dword ptr [EBX]
0040fc51: ADD EBX,0x4
0040fc54: NOT ECX
0040fc56: MOV EDI,ECX
0040fc58: SHR ECX,0x1
0040fc5a: AND EDI,0x1
0040fc5d: XOR EAX,EDI
0040fc5f: MOV EDI,EAX
0040fc61: XOR EDI,0x6954559
0040fc67: TEST AL,0x1
0040fc69: CMOVNZ EAX,EDI
0040fc6c: ADD EDX,0x1
0040fc6f: SHR EAX,0x1
0040fc71: CMP EDX,0x1066
0040fc77: JNZ 0x0040fc41
0040fc79: MOVZX EBX,byte ptr [ESI + 0xc]
0040fc7d: NOT EAX
0040fc7f: MOV ECX,EAX
0040fc81: MOV EDX,EAX
0040fc83: XOR EAX,EAX
0040fc85: SHL ECX,0x6
0040fc88: MOVZX ECX,CL
0040fc8b: AND EBX,0xc0
0040fc91: CMP EBX,ECX
0040fc93: JZ 0x0040fc99
0040fc95: POP EBX
0040fc96: POP ESI
0040fc97: POP EDI
0040fc98: RET
0040fc99: MOV ECX,EDX
0040fc9b: SHR ECX,0x2
0040fc9e: CMP byte ptr [ESI + 0xd],CL
0040fca1: JNZ 0x0040fc95
0040fca3: MOV ECX,EDX
0040fca5: SHR ECX,0xa
0040fca8: CMP byte ptr [ESI + 0xe],CL
0040fcab: JNZ 0x0040fc95
0040fcad: XOR EAX,EAX
0040fcaf: SHR EDX,0x12
0040fcb2: CMP byte ptr [ESI + 0xf],DL
0040fcb5: SETZ AL
0040fcb8: JMP 0x0040fc95