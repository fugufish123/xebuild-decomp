00410070: MOV ECX,dword ptr [ESP + 0x8]
00410074: MOV EDX,dword ptr [ESP + 0x4]
00410078: TEST ECX,ECX
0041007a: JZ 0x0041009d
0041007c: CMP byte ptr [EDX],0xff
0041007f: JNZ 0x004100a3
00410081: LEA EAX,[EDX + 0x1]
00410084: ADD EDX,ECX
00410086: JMP 0x00410099
00410090: ADD EAX,0x1
00410093: CMP byte ptr [EAX + -0x1],0xff
00410097: JNZ 0x004100a3
00410099: CMP EAX,EDX
0041009b: JNZ 0x00410090
0041009d: MOV EAX,0x1
004100a2: RET
004100a3: XOR EAX,EAX
004100a5: RET