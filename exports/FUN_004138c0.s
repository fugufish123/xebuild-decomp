004138c0: PUSH EDI
004138c1: PUSH ESI
004138c2: PUSH EBX
004138c3: SUB ESP,0x10
004138c6: MOV EBX,dword ptr [0x00479f4c]
004138cc: MOV ESI,dword ptr [EBX + 0x70]
004138cf: MOV EDX,ESI
004138d1: MOV ECX,ESI
004138d3: MOV EAX,ESI
004138d5: SHL EDX,0x18
004138d8: SHR ECX,0x18
004138db: SHL EAX,0x8
004138de: ADD ECX,EDX
004138e0: AND EAX,0xff0000
004138e5: SHR ESI,0x8
004138e8: LEA EDX,[ECX + EAX*0x1]
004138eb: AND ESI,0xff00
004138f1: MOV EAX,EDX
004138f3: MOV EDX,0x10000
004138f8: ADD EAX,ESI
004138fa: MOV ESI,dword ptr [EBX + 0x64]
004138fd: CMOVZ EAX,EDX
00413900: MOV dword ptr [ESP + 0x4],EAX
00413904: MOV EDX,ESI
00413906: MOV ECX,ESI
00413908: MOV EAX,ESI
0041390a: SHL EDX,0x18
0041390d: SHR ECX,0x18
00413910: SHL EAX,0x8
00413913: ADD ECX,EDX
00413915: AND EAX,0xff0000
0041391a: LEA EDX,[ECX + EAX*0x1]
0041391d: MOV EAX,ESI
0041391f: SHR EAX,0x8
00413922: AND EAX,0xff00
00413927: ADD EAX,EDX
00413929: ADD EAX,EBX
0041392b: MOV dword ptr [ESP],EAX
0041392e: CALL 0x00401a00
00413933: TEST EAX,EAX
00413935: MOV ESI,EAX
00413937: JZ 0x00413993
00413939: CMP byte ptr [0x00479f15],0x0
00413940: JZ 0x00413a70
00413946: MOV EBX,ESI
00413948: MOV dword ptr [ESP + 0x4],0x4522e4
00413950: MOV dword ptr [ESP],0x1
00413957: SHR EBX,0x8
0041395a: MOV dword ptr [ESP + 0x8],EBX
0041395e: CALL 0x00433690
00413963: MOV dword ptr [ESP],EBX
00413966: CALL 0x0041ade0
0041396b: MOVZX EAX,byte ptr [0x00479f15]
00413972: TEST AL,AL
00413974: JNZ 0x00413a3b
0041397a: MOV EDX,ESI
0041397c: CMP DL,0x20
0041397f: JBE 0x00413a60
00413985: MOV byte ptr [0x00479f15],0x20
0041398c: ADD ESP,0x10
0041398f: POP EBX
00413990: POP ESI
00413991: POP EDI
00413992: RET
00413993: MOV EDX,dword ptr [EBX + 0x6c]
00413996: MOV EDI,dword ptr [EBX + 0x60]
00413999: MOV ESI,EDX
0041399b: MOV EBX,EDX
0041399d: MOV ECX,EDX
0041399f: SHR ESI,0x18
004139a2: SHL EBX,0x18
004139a5: SHL ECX,0x8
004139a8: ADD EBX,ESI
004139aa: MOV ESI,EDI
004139ac: AND ECX,0xff0000
004139b2: SHL ESI,0x18
004139b5: SHR EDX,0x8
004139b8: MOV EAX,EDI
004139ba: ADD EBX,ESI
004139bc: MOV ESI,EDI
004139be: AND EDX,0xff00
004139c4: SHR ESI,0x18
004139c7: SHL EAX,0x8
004139ca: ADD ESI,EBX
004139cc: AND EAX,0xff0000
004139d1: LEA EBX,[ESI + ECX*0x1]
004139d4: LEA ECX,[EBX + EDX*0x1]
004139d7: LEA EDX,[ECX + EAX*0x1]
004139da: MOV EAX,EDI
004139dc: SHR EAX,0x8
004139df: AND EAX,0xff00
004139e4: ADD EAX,EDX
004139e6: ADD EAX,dword ptr [0x00479f4c]
004139ec: MOV dword ptr [ESP],EAX
004139ef: CALL 0x004017d0
004139f4: TEST EAX,EAX
004139f6: MOV ESI,EAX
004139f8: JNZ 0x00413939
004139fe: MOV EAX,[0x00479ea8]
00413a03: LEA EDX,[EAX + -0x6]
00413a06: CMP EDX,0x1
00413a09: JBE 0x00413ab0
00413a0f: SUB EAX,0x8
00413a12: CMP EAX,0x1
00413a15: JBE 0x00413a92
00413a17: MOV dword ptr [ESP + 0x4],0x452260
00413a1f: MOV dword ptr [ESP],0x0
00413a26: CALL 0x00433690
00413a2b: MOV EDX,0x1
00413a30: MOVZX EAX,byte ptr [0x00479f15]
00413a37: TEST AL,AL
00413a39: JZ 0x00413a60
00413a3b: MOV dword ptr [ESP + 0x8],EAX
00413a3f: MOV dword ptr [ESP + 0x4],0x45230f
00413a47: MOV dword ptr [ESP],0x1
00413a4e: CALL 0x00433690
00413a53: ADD ESP,0x10
00413a56: POP EBX
00413a57: POP ESI
00413a58: POP EDI
00413a59: RET
00413a60: MOV byte ptr [0x00479f15],DL
00413a66: ADD ESP,0x10
00413a69: POP EBX
00413a6a: POP ESI
00413a6b: POP EDI
00413a6c: RET
00413a70: MOV EAX,ESI
00413a72: MOV dword ptr [ESP + 0x4],0x4522c4
00413a7a: MOV dword ptr [ESP],0x1
00413a81: MOVZX EAX,AL
00413a84: MOV dword ptr [ESP + 0x8],EAX
00413a88: CALL 0x00433690
00413a8d: JMP 0x00413946
00413a92: MOV dword ptr [ESP + 0x4],0x452220
00413a9a: MOV dword ptr [ESP],0x1
00413aa1: CALL 0x00433690
00413aa6: XOR EDX,EDX
00413aa8: JMP 0x00413a30
00413ab0: MOV dword ptr [ESP + 0x4],0x4521e0
00413ab8: MOV dword ptr [ESP],0x1
00413abf: CALL 0x00433690
00413ac4: XOR EDX,EDX
00413ac6: JMP 0x00413a30