0040fbb0: PUSH EDI
0040fbb1: PUSH ESI
0040fbb2: XOR ECX,ECX
0040fbb4: PUSH EBX
0040fbb5: MOV EBX,dword ptr [ESP + 0x14]
0040fbb9: XOR EAX,EAX
0040fbbb: MOV ESI,dword ptr [ESP + 0x10]
0040fbbf: XOR EDX,EDX
0040fbc1: TEST DL,0x1f
0040fbc4: JNZ 0x0040fbd6
0040fbc6: CMP EDX,0x1000
0040fbcc: CMOVZ ESI,EBX
0040fbcf: MOV ECX,dword ptr [ESI]
0040fbd1: ADD ESI,0x4
0040fbd4: NOT ECX
0040fbd6: MOV EDI,ECX
0040fbd8: SHR ECX,0x1
0040fbda: AND EDI,0x1
0040fbdd: XOR EAX,EDI
0040fbdf: MOV EDI,EAX
0040fbe1: XOR EDI,0x6954559
0040fbe7: TEST AL,0x1
0040fbe9: CMOVNZ EAX,EDI
0040fbec: ADD EDX,0x1
0040fbef: SHR EAX,0x1
0040fbf1: CMP EDX,0x1066
0040fbf7: JNZ 0x0040fbc1
0040fbf9: MOVZX EDX,byte ptr [EBX + 0xc]
0040fbfd: NOT EAX
0040fbff: MOV ECX,EAX
0040fc01: SHL ECX,0x6
0040fc04: AND EDX,0x3f
0040fc07: ADD EDX,ECX
0040fc09: MOV byte ptr [EBX + 0xc],DL
0040fc0c: MOV EDX,EAX
0040fc0e: SHR EDX,0x2
0040fc11: MOV byte ptr [EBX + 0xd],DL
0040fc14: MOV EDX,EAX
0040fc16: SHR EAX,0x12
0040fc19: SHR EDX,0xa
0040fc1c: MOV byte ptr [EBX + 0xf],AL
0040fc1f: MOV byte ptr [EBX + 0xe],DL
0040fc22: POP EBX
0040fc23: POP ESI
0040fc24: POP EDI
0040fc25: RET