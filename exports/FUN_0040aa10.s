0040aa10: PUSH EBP
0040aa11: PUSH EDI
0040aa12: PUSH ESI
0040aa13: PUSH EBX
0040aa14: XOR EBX,EBX
0040aa16: SUB ESP,0x2c
0040aa19: MOV ESI,dword ptr [0x004c97ac]
0040aa1f: MOV EBP,dword ptr [ESP + 0x40]
0040aa23: TEST ESI,ESI
0040aa25: JZ 0x0040aab7
0040aa2b: MOV dword ptr [ESP],EBP
0040aa2e: MOV EDI,dword ptr [0x004c93a4]
0040aa34: CALL 0x00449078
0040aa39: SUB ESI,EAX
0040aa3b: TEST ESI,ESI
0040aa3d: MOV dword ptr [ESP + 0x1c],ESI
0040aa41: JLE 0x0040aab7
0040aa43: MOVSX ECX,byte ptr [EBP]
0040aa47: LEA ESI,[EAX + 0x1]
0040aa4a: MOV dword ptr [ESP + 0x10],ESI
0040aa4e: MOV dword ptr [ESP + 0x18],ECX
0040aa52: LEA ECX,[EDI + EAX*0x1]
0040aa55: MOV dword ptr [ESP + 0x14],ECX
0040aa59: XOR ECX,ECX
0040aa5b: JMP 0x0040aa6e
0040aa60: ADD ECX,0x1
0040aa63: ADD dword ptr [ESP + 0x14],0x1
0040aa68: CMP ECX,dword ptr [ESP + 0x1c]
0040aa6c: JZ 0x0040aac1
0040aa6e: MOVZX EDX,byte ptr [EDI + ECX*0x1]
0040aa72: CMP EDX,dword ptr [ESP + 0x18]
0040aa76: JNZ 0x0040aa60
0040aa78: XOR EDX,EDX
0040aa7a: TEST EAX,EAX
0040aa7c: JG 0x0040aa93
0040aa7e: JMP 0x0040aa9a
0040aa80: LEA EBX,[EDI + EDX*0x1]
0040aa83: MOVZX ESI,byte ptr [EBX + ECX*0x1]
0040aa87: MOVSX EBX,byte ptr [EBP + EDX*0x1]
0040aa8c: CMP ESI,EBX
0040aa8e: CMOVNZ EDX,dword ptr [ESP + 0x10]
0040aa93: ADD EDX,0x1
0040aa96: CMP EAX,EDX
0040aa98: JG 0x0040aa80
0040aa9a: CMP EAX,EDX
0040aa9c: JNZ 0x0040aa60
0040aa9e: MOV ESI,dword ptr [ESP + 0x14]
0040aaa2: LEA EDX,[EAX + ECX*0x1]
0040aaa5: CMP byte ptr [ESI],0x0
0040aaa8: JZ 0x0040aa60
0040aaaa: CMP EDX,-0x1
0040aaad: MOV EBX,0x0
0040aab2: CMOVNZ EBX,dword ptr [ESP + 0x14]
0040aab7: ADD ESP,0x2c
0040aaba: MOV EAX,EBX
0040aabc: POP EBX
0040aabd: POP ESI
0040aabe: POP EDI
0040aabf: POP EBP
0040aac0: RET
0040aac1: ADD ESP,0x2c
0040aac4: XOR EBX,EBX
0040aac6: MOV EAX,EBX
0040aac8: POP EBX
0040aac9: POP ESI
0040aaca: POP EDI
0040aacb: POP EBP
0040aacc: RET