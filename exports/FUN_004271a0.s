004271a0: PUSH EBP
004271a1: PUSH EDI
004271a2: PUSH ESI
004271a3: PUSH EBX
004271a4: SUB ESP,0x21c
004271aa: MOV ESI,dword ptr [ESP + 0x230]
004271b1: MOV dword ptr [ESP],ESI
004271b4: CALL 0x00449078
004271b9: TEST EAX,EAX
004271bb: JS 0x00427231
004271bd: MOV EDI,EAX
004271bf: XOR EDX,EDX
004271c1: XOR EBX,EBX
004271c3: LEA EBP,[ESP + 0x10]
004271c7: JMP 0x004271e2
004271d0: TEST AL,AL
004271d2: JZ 0x004271ea
004271d4: ADD EBX,0x1
004271d7: MOV byte ptr [ESP + EDX*0x1 + 0x10],AL
004271db: ADD EDX,0x1
004271de: CMP EDI,EBX
004271e0: JL 0x00427231
004271e2: MOVZX EAX,byte ptr [ESI + EBX*0x1]
004271e6: CMP AL,0x3b
004271e8: JNZ 0x004271d0
004271ea: MOV byte ptr [ESP + EDX*0x1 + 0x10],0x0
004271ef: MOV EDX,EBP
004271f1: MOV ECX,dword ptr [EDX]
004271f3: ADD EDX,0x4
004271f6: LEA EAX,[ECX + 0xfefefeff]
004271fc: NOT ECX
004271fe: AND EAX,ECX
00427200: AND EAX,0x80808080
00427205: JZ 0x004271f1
00427207: MOV ECX,EAX
00427209: SHR ECX,0x10
0042720c: TEST EAX,0x8080
00427211: CMOVZ EAX,ECX
00427214: LEA ECX,[EDX + 0x2]
00427217: CMOVZ EDX,ECX
0042721a: MOV ECX,EAX
0042721c: ADD CL,AL
0042721e: SBB EDX,0x3
00427221: SUB EDX,EBP
00427223: CMP EDX,0x4
00427226: JA 0x00427241
00427228: XOR EDX,EDX
0042722a: ADD EBX,0x1
0042722d: CMP EDI,EBX
0042722f: JGE 0x004271e2
00427231: MOV EAX,0x1
00427236: ADD ESP,0x21c
0042723c: POP EBX
0042723d: POP ESI
0042723e: POP EDI
0042723f: POP EBP
00427240: RET
00427241: MOV dword ptr [ESP],EBP
00427244: CALL 0x00427000
00427249: TEST EAX,EAX
0042724b: JZ 0x00427236
0042724d: XOR EDX,EDX
0042724f: JMP 0x0042722a